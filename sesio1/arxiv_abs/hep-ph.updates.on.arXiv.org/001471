Since the discovery of an excess in gamma rays in the direction of M31, its cause has been unclear.
Published interpretations focus on a dark matter or stellar related origin. Studies of a similar
excess in the Milky Way center motivate a correlation of the spatial morphology of the signal with
the distribution of stellar mass in M31. However, a robust determination of the best theory for the
observed excess emission is very challenging due to large uncertainties in the astrophysical gamma-ray
foreground model. Here we perform a spectro-morphological analysis of the M31 gamma-ray excess
using state-of-the-art templates for the distribution of stellar mass in M31 and novel astrophysical
foreground models for its sky region. We construct maps for the old stellar populations of M31 based
on observational data from the PAndAS survey and carefully remove the foreground stars. We also
produce improved astrophysical foreground models by using novel image inpainting techniques
based on machine learning methods. We find that our stellar maps, taken as a proxy for the location
of a putative population of millisecond pulsars in the bulge of M31, reach a statistical significance
of $5.4\sigma$, making them as strongly favoured as the simple phenomenological models usually
considered in the literature, e.g., a disk-like template with uniform brightness. Our detection
of the stellar templates is robust to generous variations of the astrophysical foreground model.
Once the stellar templates are included in the astrophysical model, we show that the dark matter
annihilation interpretation of the signal is unwarranted. Using the results of a binary population
synthesis model we demonstrate that a population of about one million unresolved MSPs could naturally
explain the observed gamma-ray luminosity per stellar mass, energy spectrum, and stellar bulge-to-disk
flux ratio. 