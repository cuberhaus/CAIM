Let $\mathbf{H}$ be the cartesian product of a family of abelian groups indexed by a finite set $\Omega$.
A given poset $\mathbf{P}=(\Omega,\preccurlyeq_{\mathbf{P}})$ and a map $\omega:\Omega\longrightarrow\mathbb{R}^{+}$
give rise to the $(\mathbf{P},\omega)$-weight on $\mathbf{H}$, which further leads to a partition
$\mathcal{Q}(\mathbf{H},\mathbf{P},\omega)$ of $\mathbf{H}$. For the case that $\mathbf{H}$
is finite, we give sufficient conditions for two codewords to belong to the same block of $\Lambda$,
the dual partition of $\mathbf{H}$, and sufficient conditions for $\mathbf{H}$ to be Fourier-reflexive.
By relating the involved partitions with certain polynomials, we show that such sufficient conditions
are also necessary if $\mathbf{P}$ is hierarchical and $\omega$ is integer valued. With $\mathbf{H}$
set to be a finite vector space over a finite field $\mathbb{F}$, we extend the property of ``admitting
MacWilliams identity'' to arbitrary pairs of partitions of $\mathbf{H}$, and prove that a pair
of $\mathbb{F}$-invariant partitions $(\Lambda,\Gamma)$ with $|\Lambda|=|\Gamma|$ admits
MacWilliams identity if and only if $(\Lambda,\Gamma)$ is a pair of mutually dual Fourier-reflexive
partitions. Such a result is applied to the partitions induced by $\mathbf{P}$-weight and $(\mathbf{P},\omega)$-weight.
With $\mathbf{H}$ set to be a left module over a ring $S$, we show that each $(\mathbf{P},\omega)$-weight
isometry of $\mathbf{H}$ induces an order automorphism of $\mathbf{P}$, which leads to a group
homomorphism from the group of $(\mathbf{P},\omega)$-weight isometries to $\Aut(\mathbf{P})$,
whose kernel consists of isometries preserving the $\mathbf{P}$-support. Finally, by studying
MacWilliams extension property with respect to $\mathbf{P}$-support, we give a canonical decomposition
for semi-simple codes $C\subseteq\mathbf{H}$ with $\mathbf{P}$ set to be hierarchical. 