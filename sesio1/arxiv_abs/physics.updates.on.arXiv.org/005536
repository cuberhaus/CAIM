Recent detector concepts at future linear or circular $e^- e^+$ colliders emphasize the benefits
of time-of-flight measurements for particle identification of long-lived charged hadrons. That
method relies on a precise estimation of the time-of-flight as expected, for a given mass hypothesis,
from the reconstructed particle momentum and its trajectory. We show that for a realistic detector
set-up, relativistic formulae are a good approximation down to lowest possible momenta. The optimally
fitted track parameters are commonly defined near the interaction region. Extrapolation to a time-of-flight
counter located behind the central tracking device can usually only be performed by a track model
undisturbed from material effects. However, the true trajectory is distorted by multiple Coulomb
scattering and the momentum is changed by energy loss. As a consequence, the estimated time-of-flight
is biased by a large systematic error. This study presents a novel approach of time-of-flight estimation
by splitting the trajectory into a chain of undisturbed track elements, following as close as possible
the true trajectory. Each track element possesses an individual momentum $p_i$ and flight distance
$l_i$. Remarkably, our formulae emerge by formally replacing the global momentum squared $p^2$
by the weighted harmonic mean of the individual $\{ p_i^2 \}$, with the weights being the corresponding
individual $\{ l_i \}$. The optimally fitted parameters of the individual track elements can be
obtained from track reconstruction by a Kalman filter plus smoother. However, care must be taken
when including mass-dependent material effects. Explicit formulae for a simple scenario (homogeneous
magnetic field and cylindrical surfaces) are given, together with an overview about the treatment
of multiple Coulomb scattering and energy loss by a Kalman filter. 