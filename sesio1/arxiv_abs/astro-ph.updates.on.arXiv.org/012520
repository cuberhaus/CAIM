We investigated the applicability of the weak-field approximation (WFA) for retrieving the depth-dependent
line-of-sight (LOS) magnetic field from the spectral region containing the Mg I $b_2$ spectral
line and two photospheric Ti I and Fe I lines. We constructed and used a 12-level model for Mg I atom
that realistically reproduces the $b_2$ line profile of the mean quiet Sun. We tested the applicability
of the WFA to the spectra computed from the FAL C atmospheric model with ad hoc added different magnetic
and velocity fields. Then, we extended the analysis to the spectra computed from two 3D magneto-hydrodynamic
(MHD) MURaM simulations of the solar atmosphere. The first MHD cube is used to estimate the Stokes
V formation heights of each spectral line. These heights correspond to optical depths at which the
standard deviation of the difference between the WFA-inferred magnetic field and the magnetic
field in the MHD cube is minimal. The estimated formation heights are verified using the second MHD
cube. The LOS magnetic field retrieved by the WFA is reliable for the magnetic field strength up to
1.4 kG even when moderate velocity gradients are present. The exception is the Fe I line, for which
we found a strong discrepancy in the inferred magnetic fields because of the line blend. We estimated
the Stokes $V$ formation heights of each spectral line to be: $\log\tau_\mathrm{Fe}=-2.6$, $\log\tau_\mathrm{Mg}=-3.3$,
and $\log\tau_\mathrm{Ti}=-1.8$. We were able to estimate the LOS magnetic field from the MURaM
cube at these heights with the uncertainty of 150 G for the Fe I and Ti I lines and only 40 G for the Mg I
$b_2$ line. Using the WFA we can quickly get a reliable estimate of the structure of the LOS magnetic
field in the observed region. The Mg I $b_2$ line profile calculated from the quiet Sun MURaM simulation
agrees very well with the observed mean spectrum of the quiet Sun. 