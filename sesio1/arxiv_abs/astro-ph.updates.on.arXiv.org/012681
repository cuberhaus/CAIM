Long-duration $\gamma$-ray bursts (GRBs) accompany the collapse of massive stars and carry important
information about the central engine. However, no 3D models have been able to follow these jets from
their birth by a rotating black-hole (BH) to the photosphere. We present the first such 3D general-relativity
magnetohydrodynamic simulations, which span over $6$ orders of magnitude in space and time. The
collapsing stellar envelope forms an accretion disk, which drags inward the magnetic flux that
accumulates around the BH, becomes dynamically-important and launches bipolar jets. The jets
reach the photosphere at $\sim10^{12}$ cm with an opening angle, $\theta_j\sim6^\circ$ and a Lorentz
factor, $\Gamma_j\lesssim30$, unbind $\gtrsim90\%$ of the star and leave the BH mass essentially
unchanged after the initial core-collapse. We find that: (i) The disk-jet system spontaneously
develops misalignment relative to the BH rotational axis. As a result, the jet direction wobbles
with an angle $\theta_t\sim12^\circ$, which can naturally explain quiescent times in GRB lightcurves.
The effective opening angle for detection $\theta_j+\theta_t$ suggests that the intrinsic (beaming-corrected)
GRB rate is lower by an order of magnitude than standard estimates. This implies that successful
GRBs can be much rarer than currently thought, and emerge in only $\sim0.1\%$ of supernovae Ib/c.
A possible explanation is that jets are either not launched or choked inside most supernova Ib/c
progenitors. (ii) The magnetic energy in the jet decreases due to dissipation and mixing with the
stellar material, resulting in jets with a hybrid composition of magnetic and thermal components
at the photosphere, where $\sim 20\%$ of the gas maintains magnetization $\sigma\gtrsim0.1$.
This indicates that both a photospheric component and magnetic reconnection may play a role in the
GRB prompt emission. 